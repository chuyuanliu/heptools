
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Config Parser &#8212; HEP tools  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/admonition.css?v=c8b93dda" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'guide/optional/config_parser';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="API reference" href="../../api.html" />
    <link rel="prev" title="Optional Components" href="../optional.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">HEP tools  documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../guide.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/chuyuanliu/heptools" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../guide.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api.html">
    API reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/chuyuanliu/heptools" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../howto.html">How-to</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../howto/construct_friend_tree.html">Construct <code class="xref py py-class docutils literal notranslate"><span class="pre">Friend</span></code> Tree</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../optional.html">Optional Components</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Config Parser</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../guide.html" class="nav-link">User guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="../optional.html" class="nav-link">Optional Components</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Config Parser</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="config-parser">
<h1>Config Parser<a class="headerlink" href="#config-parser" title="Link to this heading">#</a></h1>
<p>This tool provides a flexible framework to load and merge configurations from different sources for Python projects. A tag style syntax is introduced to control the loading or merging behavior.</p>
<section id="quick-start">
<h2>Quick Start<a class="headerlink" href="#quick-start" title="Link to this heading">#</a></h2>
<section id="write-configs">
<h3>Write configs<a class="headerlink" href="#write-configs" title="Link to this heading">#</a></h3>
<p>A config is any file that can be deserialized into a python dictionary. Common formats including <code class="docutils literal notranslate"><span class="pre">.yaml</span></code> (<code class="docutils literal notranslate"><span class="pre">.yml</span></code>), <code class="docutils literal notranslate"><span class="pre">.json</span></code> and <code class="docutils literal notranslate"><span class="pre">.toml</span></code> are supported out of the box. Other formats may require a <a class="reference internal" href="#config-custom-deserializer"><span class="std std-ref">File deserializer</span></a>.</p>
<p><a class="reference internal" href="#config-tag"><span class="std std-ref">Tag</span></a> syntax extends the existing serialization languages to support complicated control flows or python specific features, e.g. include directive, variable definition, python object initialization, etc. An example is available in <a class="reference external" href="https://github.com/chuyuanliu/heptools/tree/master/examples/advanced-yaml-config">advanced-yaml-config</a>.</p>
</section>
<section id="load-configs">
<h3>Load configs<a class="headerlink" href="#load-configs" title="Link to this heading">#</a></h3>
<p>An instance of <a class="reference internal" href="../../api/config.html#heptools.config.ConfigParser" title="heptools.config.ConfigParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigParser</span></code></a> is used to load config files and parse the tags. The default setup is sufficient for most use cases, while <a class="reference internal" href="#config-customization"><span class="std std-ref">Customization</span></a> is possible through the arguments of <a class="reference internal" href="../../api/config.html#heptools.config.ConfigParser" title="heptools.config.ConfigParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">__init__()</span></code></a>. Each <a class="reference internal" href="../../api/config.html#heptools.config.ConfigParser.__call__" title="heptools.config.ConfigParser.__call__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code></a>  will create a new context to maintain local variables and return the parsed configs in a single dictionary.</p>
<p>The parsing is performed in two passes:</p>
<ul class="simple">
<li><p>Deserialize the files into dictionaries.</p></li>
<li><p>Apply the tags.</p></li>
</ul>
<p>The order of the paths provided to <a class="reference internal" href="../../api/config.html#heptools.config.ConfigParser.__call__" title="heptools.config.ConfigParser.__call__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code></a> and the order of keys and items from the first pass are preserved to the final output. The tags are parsed recursively from innermost to outermost.</p>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">heptools.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConfigParser</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
<span class="n">configs</span> <span class="o">=</span> <span class="n">parser</span><span class="p">(</span><span class="s2">&quot;config1.yml&quot;</span><span class="p">,</span> <span class="s2">&quot;config2.yml&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="tag">
<span id="config-tag"></span><h2>Tag<a class="headerlink" href="#tag" title="Link to this heading">#</a></h2>
<section id="syntax">
<h3>Syntax<a class="headerlink" href="#syntax" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>A tag is defined as a key-value pair given by <code class="docutils literal notranslate"><span class="pre">&lt;tag_key=tag_value&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;tag_key&gt;</span></code> if the tag value is <code class="docutils literal notranslate"><span class="pre">None</span></code>. Newlines are not allowed within a tag.</p></li>
<li><p>Arbitrary number of tags can be attached to a key.</p></li>
<li><p>The spaces and newlines between the key and tags are optional.</p></li>
</ul>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<p>The following are examples of valid tags:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="nt">key&lt;tag_key&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="nt">key &lt;tag_key=tag_value&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="nt">key   &lt;tag_key1=tag_value1&gt;&lt;tag_key2&gt;  &lt;tag_key3=tag_value3&gt;  </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="nt">&lt;tag_key1&gt; &lt;tag_key2=tag_value2&gt;  </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="p p-Indicator">?</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">key</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">&lt;tag_key1&gt; &lt;tag_key2=tag_value2&gt;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">&lt;tag_key3=tag_value3&gt;</span>
<span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
</pre></div>
</div>
</div>
</section>
<section id="precedence">
<span id="config-rule-precedence"></span><h3>Precedence<a class="headerlink" href="#precedence" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The tags are parsed from left to right based on the order of appearance.</p></li>
<li><p>The same tag can be applied multiple times.</p></li>
<li><p>The parsing result is order dependent. See <a class="reference internal" href="#config-custom-tag"><span class="std std-ref">Tag parser</span></a>.</p></li>
<li><p>Some of the built-in tags follow special rules:</p>
<ul>
<li><p><a class="reference internal" href="#config-tag-code"><span class="std std-ref">&lt;code&gt;</span></a> have the highest precedence and will only be parsed once.</p></li>
<li><p>The following tags will not trigger any parser.</p>
<ul>
<li><p><a class="reference internal" href="#config-tag-case"><span class="std std-ref">&lt;case&gt;</span></a></p></li>
<li><p><a class="reference internal" href="#config-tag-literal"><span class="std std-ref">&lt;literal&gt;</span></a></p></li>
<li><p><a class="reference internal" href="#config-tag-discard"><span class="std std-ref">&lt;discard&gt;</span></a></p></li>
<li><p><a class="reference internal" href="#config-tag-comment"><span class="std std-ref">&lt;comment&gt;</span></a></p></li>
</ul>
</li>
<li><p>The order of the following tags are ill-defined, as they are not supposed to simply modify the key-value pairs. As a result, they cannot be directly chained with other regular tags, unless through <a class="reference internal" href="#config-tag-code"><span class="std std-ref">&lt;code&gt;</span></a>. See <a class="reference internal" href="#config-tips-include"><span class="std std-ref">Dynamic &lt;include&gt;</span></a>.</p>
<ul>
<li><p><a class="reference internal" href="#config-tag-select"><span class="std std-ref">&lt;select&gt;</span></a></p></li>
<li><p><a class="reference internal" href="#config-tag-include"><span class="std std-ref">&lt;include&gt;</span></a></p></li>
<li><p><a class="reference internal" href="#config-tag-patch"><span class="std std-ref">&lt;patch&gt;</span></a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="url-and-io">
<span id="config-rule-url"></span><h3>URL and IO<a class="headerlink" href="#url-and-io" title="Link to this heading">#</a></h3>
<p>Both the <a class="reference internal" href="../../api/config.html#heptools.config.ConfigParser" title="heptools.config.ConfigParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigParser</span></code></a> and built-in tags <a class="reference internal" href="#config-tag-include"><span class="std std-ref">&lt;include&gt;</span></a>, <a class="reference internal" href="#config-tag-file"><span class="std std-ref">&lt;file&gt;</span></a> shares the same IO mechanism.</p>
<p>The file path is described by a standard URL accepted by <a class="reference external" href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urlparse" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">urlparse()</span></code></a> with the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[scheme://netloc/]path[;parameters][?query][#fragment]
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scheme://netloc/</span></code> can be omitted for local path.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">;parameters</span></code> is never used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">?query</span></code> can be used to provide additional key-value pairs. If a key appears multiple times, all values will be collected into a list. Values are interpreted as JSON strings.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#fragment</span></code> is a dot-separated path, allowing to access nested dictionaries or lists. Similar to <code class="docutils literal notranslate"><span class="pre">TOML</span></code>’s <a class="reference external" href="https://toml.io/en/v1.0.0#table">table</a>, double quotes can be used to escape the dot.</p></li>
<li><p>The <a class="reference external" href="https://en.wikipedia.org/wiki/Percent-encoding">percentage-encoding</a> rule (<code class="docutils literal notranslate"><span class="pre">%XX</span></code>) is supported in the <code class="docutils literal notranslate"><span class="pre">path</span></code> to escape special characters.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">#fragment</span></code> is extracted before any parsing.</p>
</div>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<p>The following URLs are all valid:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">local path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/file.yml</span>
<span class="nt">XRootD path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">root://server.host//path/to/file.yml</span>
<span class="nt">fragment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/file.yml#key1.key2 &lt;extend&gt;.0.&quot;key3.key4&quot;</span>
<span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/file.yml?key1=value1&amp;key2=value2&amp;key1=value3&amp;key3=[1,2,3]&amp;parent.child=value4</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">fragment</span></code> example above is equivalent to the pseudo code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/path/to/file.yml&quot;</span><span class="p">))[</span><span class="s2">&quot;key1&quot;</span><span class="p">][</span><span class="s2">&quot;key2 &lt;extend&gt;&quot;</span><span class="p">][</span><span class="nb">int</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">)][</span><span class="s2">&quot;key3.key4&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">query</span></code> example above will give an additional dictionary</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;key1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;value1&quot;</span><span class="p">,</span> <span class="s2">&quot;value3&quot;</span><span class="p">],</span>
  <span class="s2">&quot;key2&quot;</span><span class="p">:</span> <span class="s2">&quot;value2&quot;</span><span class="p">,</span>
  <span class="s2">&quot;key3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
  <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;child&quot;</span><span class="p">:</span> <span class="s2">&quot;value4&quot;</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>File IO is handled by <a class="reference external" href="https://filesystem-spec.readthedocs.io/en/latest/api.html#fsspec.open" title="(in fsspec v2025.5.1.post0+g66340a1.d20250524)"><code class="xref py py-func docutils literal notranslate"><span class="pre">fsspec.open()</span></code></a> and the deserialization is handled by <a class="reference internal" href="../../api/config.html#heptools.config.ConfigParser.io" title="heptools.config.ConfigParser.io"><code class="xref py py-data docutils literal notranslate"><span class="pre">ConfigParser.io</span></code></a>, an instance of <a class="reference internal" href="../../api/config.html#heptools.config.FileLoader" title="heptools.config.FileLoader"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileLoader</span></code></a>.</p>
<ul class="simple">
<li><p>The compression format is inferred from the last extension, see <code class="xref py py-data docutils literal notranslate"><span class="pre">fsspec.utils.compressions</span></code>.</p></li>
<li><p>The deserializer is inferred from the longest registered extension that does not match any compression format.</p></li>
<li><p>The deserialized objects will be catched, and can be cleared by <a class="reference internal" href="../../api/config.html#heptools.config.FileLoader.clear_cache" title="heptools.config.FileLoader.clear_cache"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConfigParser.io.clear_cache</span></code></a>.</p></li>
</ul>
</section>
<section id="special">
<h3>Special<a class="headerlink" href="#special" title="Link to this heading">#</a></h3>
<section id="nested-true-in-configparser">
<span id="config-special-nested"></span><h4><code class="docutils literal notranslate"><span class="pre">nested=True</span></code> in <a class="reference internal" href="../../api/config.html#heptools.config.ConfigParser" title="heptools.config.ConfigParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigParser</span></code></a><a class="headerlink" href="#nested-true-in-configparser" title="Link to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">nested=True</span></code> (default) option enables a behavior similar to <code class="docutils literal notranslate"><span class="pre">TOML</span></code>’s <a class="reference external" href="https://toml.io/en/v1.0.0#table">table</a>, where the dot-separated keys will be interpreted as accessing a nested dictionary and the parents will not be overriden. Use double quotes or <a class="reference internal" href="#config-tag-literal"><span class="std std-ref">&lt;literal&gt;</span></a> to escape the keys with dot.</p>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">parent1</span><span class="p">:</span>
<span class="w">  </span><span class="nt">child1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>
<span class="nt">parent1 &lt;comment&gt;</span><span class="p">:</span><span class="w"> </span><span class="c1"># override the parent</span>
<span class="w">  </span><span class="nt">child2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value2</span>
<span class="nt">parent1.child3</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value3</span><span class="w"> </span><span class="c1"># modify the child without overriding the parent</span>
<span class="nt">parent2.child.grandchild</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value4</span><span class="w"> </span><span class="c1"># create a nested dict</span>
</pre></div>
</div>
<p>will be parsed into</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;parent1&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;child2&quot;</span><span class="p">:</span> <span class="s2">&quot;value2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;child3&quot;</span><span class="p">:</span> <span class="s2">&quot;value3&quot;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="s2">&quot;parent2&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;child&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;grandchild&quot;</span><span class="p">:</span> <span class="s2">&quot;value4&quot;</span><span class="p">}},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="none-key">
<h4><code class="docutils literal notranslate"><span class="pre">None</span></code> key<a class="headerlink" href="#none-key" title="Link to this heading">#</a></h4>
<p>Besides the standard rules, both <code class="docutils literal notranslate"><span class="pre">~</span></code> and empty string in the key will be parsed into <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># None</span>
<span class="nt">~</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="nt">~ &lt;tag&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="s">&quot;&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="nt">&lt;tag&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="nt">null</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>

<span class="c1"># not None</span>
<span class="nt">null &lt;tag&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
</pre></div>
</div>
</div>
</section>
<section id="apply-to-list-elements">
<span id="config-special-list"></span><h4>Apply to <code class="docutils literal notranslate"><span class="pre">list</span></code> elements<a class="headerlink" href="#apply-to-list-elements" title="Link to this heading">#</a></h4>
<p>When the element is a dictionary and the only key is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the element will be replaced by its value. Use <a class="reference internal" href="#config-tag-literal"><span class="std std-ref">&lt;literal&gt;</span></a> to retain the original dictionary.</p>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>
<span class="w">  </span><span class="nt">&lt;tag&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value2</span><span class="w"> </span><span class="c1"># regular None key</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">&lt;tag&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value3</span><span class="w"> </span><span class="c1"># replace the whole element with its value</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">&lt;tag&gt; &lt;literal&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value4</span><span class="w"> </span><span class="c1"># escape the None key</span>
</pre></div>
</div>
<p>will be parsed into</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">{</span><span class="s2">&quot;key1&quot;</span><span class="p">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">:</span> <span class="s2">&quot;value2&quot;</span><span class="p">},</span>
  <span class="s2">&quot;value3&quot;</span><span class="p">,</span>
  <span class="p">{</span><span class="kc">None</span><span class="p">:</span> <span class="s2">&quot;value4&quot;</span><span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>
<section id="built-in-tags">
<h2>Built-in tags<a class="headerlink" href="#built-in-tags" title="Link to this heading">#</a></h2>
<section id="code">
<span id="config-tag-code"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;code&gt;</span></code><a class="headerlink" href="#code" title="Link to this heading">#</a></h3>
<p>This tag will replace the value by the result of <a class="reference external" href="https://docs.python.org/3/library/functions.html#eval" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">eval()</span></code></a>. The variables defined with <a class="reference internal" href="#config-tag-var"><span class="std std-ref">&lt;var&gt;</span></a> are available as <code class="docutils literal notranslate"><span class="pre">locals</span></code>.</p>
<div class="guide-config-value admonition">
<p class="admonition-title">value</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: a python expression</p></li>
</ul>
</div>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">key &lt;code&gt;</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;[f&quot;item{i}&quot;</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">i</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">range(100)]&#39;</span>
</pre></div>
</div>
</div>
</section>
<section id="include">
<span id="config-tag-include"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;include&gt;</span></code><a class="headerlink" href="#include" title="Link to this heading">#</a></h3>
<p>This tag allows to merge dictionaries from other config files into the given level and will be parsed under the current context.</p>
<div class="guide-config-tag admonition">
<p class="admonition-title">tag</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;include&gt;</span></code>: the type of the path will be inferred.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;include=absolute&gt;</span></code>: resolve as an absolute path.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;include=relative&gt;</span></code>: resolve as an path relative to the current config file.</p></li>
</ul>
</div>
<div class="guide-config-value admonition">
<p class="admonition-title">value</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: a URL to a dictionary</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code>: a list of URLs</p></li>
<li><p>To include within the same file, use <code class="docutils literal notranslate"><span class="pre">.</span></code> as path.</p></li>
<li><p>The rules in <a class="reference internal" href="#config-rule-url"><span class="std std-ref">URL and IO</span></a> apply.</p></li>
</ul>
</div>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span><span class="w"> </span><span class="c1"># file1.yml</span>
<span class="nt">key1</span><span class="p">:</span>
<span class="w">  </span><span class="nt">key1_1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>

<span class="nn">---</span><span class="w"> </span><span class="c1"># file2.yml</span>
<span class="nt">key2</span><span class="p">:</span>
<span class="w">  </span><span class="nt">key2_1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>
<span class="w">  </span><span class="nt">key2_2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value2</span>
<span class="nt">key3</span><span class="p">:</span>
<span class="w">  </span><span class="nt">&lt;include&gt;</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">file1.yml#key1</span><span class="w"> </span><span class="c1"># include another file using a relative path</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.#key2</span><span class="w"> </span><span class="c1"># include within the same file</span>
</pre></div>
</div>
<p>Then <code class="docutils literal notranslate"><span class="pre">file2.yml#key3</span></code> will give</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;key1_1&quot;</span><span class="p">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;key2_1&quot;</span><span class="p">:</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;key2_2&quot;</span><span class="p">:</span> <span class="s2">&quot;value2&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="literal">
<span id="config-tag-literal"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;literal&gt;</span></code><a class="headerlink" href="#literal" title="Link to this heading">#</a></h3>
<p>The keys marked as <code class="docutils literal notranslate"><span class="pre">&lt;literal&gt;</span></code> will not trigger the following rules:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#config-special-nested"><span class="std std-ref">nested=True in ConfigParser</span></a></p></li>
<li><p><a class="reference internal" href="#config-special-list"><span class="std std-ref">Apply to list elements</span></a></p></li>
</ul>
</section>
<section id="discard">
<span id="config-tag-discard"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;discard&gt;</span></code><a class="headerlink" href="#discard" title="Link to this heading">#</a></h3>
<p>The keys marked as <code class="docutils literal notranslate"><span class="pre">&lt;discard&gt;</span></code> will not be added into the current dictionary but will still be parsed. This is useful when only the side effects of the parsing are needed. e.g. define variables, execute code, etc.</p>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;discard&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="nt">var1 &lt;var&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>
<span class="w">  </span><span class="nt">&lt;type=print&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello World</span>
<span class="nt">key1 &lt;ref&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">var1</span>
</pre></div>
</div>
<p>The example above will print <code class="docutils literal notranslate"><span class="pre">Hello</span> <span class="pre">World</span></code> and be parsed into <code class="docutils literal notranslate"><span class="pre">{'key1':</span> <span class="pre">'value1'}</span></code>.</p>
</div>
</section>
<section id="comment">
<span id="config-tag-comment"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;comment&gt;</span></code><a class="headerlink" href="#comment" title="Link to this heading">#</a></h3>
<p>This tag is reserved to never trigger any parser. This is useful when you want to leave a comment or add keys with duplicate names.</p>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">key &lt;comment=this is a counter&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">key &lt;extend&gt; &lt;comment=1&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="nt">key &lt;extend&gt; &lt;comment=2&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="nt">key &lt;extend&gt; &lt;comment=3&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
</pre></div>
</div>
<p>The example above will be parsed into <code class="docutils literal notranslate"><span class="pre">{'key':</span> <span class="pre">10}</span></code>.</p>
</div>
</section>
<section id="file">
<span id="config-tag-file"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;file&gt;</span></code><a class="headerlink" href="#file" title="Link to this heading">#</a></h3>
<p>This tag allows to insert any deserialized object from a URL. Unlike <a class="reference internal" href="#config-tag-include"><span class="std std-ref">&lt;include&gt;</span></a>, this tag will only replace the value by a deep copy of the loaded object, instead of merging it into the current dictionary. If the object is large and only used once, it is recommended to turn off the cache to avoid the deep copy.</p>
<div class="guide-config-tag admonition">
<p class="admonition-title">tag</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;file&gt;</span></code>: the type of the path will be inferred.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;file=absolute&gt;</span></code>: resolve as an absolute path.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;file=relative&gt;</span></code>: resolve as an path relative to the current config file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;file=nocache&gt;</span></code>: turn off the cache.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;file=nobuffer&gt;</span></code>: turn off the buffer.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">|</span></code> to separate multiple flags: <code class="docutils literal notranslate"><span class="pre">&lt;file=relative|nocache|nobuffer&gt;</span></code></p></li>
</ul>
</div>
<div class="guide-config-value admonition">
<p class="admonition-title">value</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: a URL to any object</p></li>
<li><p>The rules in <a class="reference internal" href="#config-rule-url"><span class="std std-ref">URL and IO</span></a> apply.</p></li>
</ul>
</div>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<p>Given a compressed pickle file <code class="docutils literal notranslate"><span class="pre">database.pkl.lz4</span></code> created by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">lz4</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;database.pkl.lz4&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">({</span><span class="s2">&quot;column1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">},</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">key1 &lt;file&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">database.pkl.lz4#column1</span>
<span class="nt">key2 &lt;file=nocache&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">database.pkl.lz4#column1</span>
</pre></div>
</div>
<p>will be parsed into <code class="docutils literal notranslate"><span class="pre">{&quot;key1&quot;:</span> <span class="pre">[0,</span> <span class="pre">...,</span> <span class="pre">0],</span> <span class="pre">&quot;key2&quot;:</span> <span class="pre">[0,</span> <span class="pre">...,</span> <span class="pre">0]}</span></code>, while the cache is disabled when parsing key2.</p>
</div>
</section>
<section id="type">
<span id="config-tag-type"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;type&gt;</span></code><a class="headerlink" href="#type" title="Link to this heading">#</a></h3>
<p>This tag can be used to import a module/attribute, create an instance of a class, or call a function.</p>
<div class="guide-config-tag admonition">
<p class="admonition-title">tag</p>
<ul class="simple">
<li><p>An import path is defined as <code class="docutils literal notranslate"><span class="pre">{module}::{attribute}</span></code>, which is roughly equivalent to the python statement <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">{module}</span> <span class="pre">import</span> <span class="pre">{attribute}</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">{module}::</span></code> can be omitted for <a class="reference external" href="https://docs.python.org/3/library/functions.html" title="(in Python v3.13)"><span>Built-in Functions</span></a>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">{attribute}</span></code> is not provided or only contains dots, the whole module will be returned.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{attribute}</span></code> can be a dot separated string to get a similar effect as <a class="reference internal" href="#config-tag-attr"><span class="std std-ref">&lt;attr&gt;</span></a>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;type&gt;</span></code>: when the tag value is not provided, the value must be a valid import path ande will be replaced by the imported object.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;type={module::attribute}&gt;</span></code>: when the tag value is provided, the imported object will be called with the value as its arguments.</p></li>
</ul>
</div>
<div class="guide-config-value admonition">
<p class="admonition-title">value</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;type&gt;</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">str</span></code>: a valid import path <code class="docutils literal notranslate"><span class="pre">{module}::{attribute}</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;type={module::attribute}&gt;</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">module.attribute(*value)</span></code>: if the value is a list, it will be used as positional arguments.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">module.attribute(**value)</span></code>: If the value is a dict and only contains string keys, the string keys will be used as keyword arguments.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">module.attribute(*value[None],</span> <span class="pre">**value[others])</span></code>: If the value is a dict and the <code class="docutils literal notranslate"><span class="pre">None</span></code> key is a list, the <code class="docutils literal notranslate"><span class="pre">None</span></code> key will be used as positional arguments.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">module.attribute(value[None],</span> <span class="pre">**value[others])</span></code>: If the value is a dict and the <code class="docutils literal notranslate"><span class="pre">None</span></code> key is not a list, the <code class="docutils literal notranslate"><span class="pre">None</span></code> key will be used as the first argument.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">module.attribute(value)</span></code>: If the value is neither a list nor a dict, it will be used as the first argument.</p></li>
</ul>
</li>
</ul>
</div>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">key1 &lt;type&gt;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;json::&quot;</span><span class="w"> </span><span class="c1"># import a module</span>
<span class="nt">key2 &lt;type&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json::.</span><span class="w"> </span><span class="c1"># the same as key1</span>
<span class="nt">key3 &lt;type&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json::loads</span><span class="w"> </span><span class="c1"># import a function</span>
<span class="nt">key4 &lt;type&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">json::loads.__qualname__</span><span class="w"> </span><span class="c1"># import a nested attribute</span>
<span class="nt">key5 &lt;type=range&gt;</span><span class="p">:</span><span class="w"> </span><span class="c1"># create an instance of a built-in class</span>
<span class="w">  </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">100</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># positional arguments</span>
<span class="nt">&lt;discard&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="nt">&lt;type=logging::basicConfig&gt;</span><span class="p">:</span>
<span class="w">    </span><span class="nt">level &lt;type&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">logging::INFO</span><span class="w"> </span><span class="c1"># import an object</span>
<span class="w">  </span><span class="nt">&lt;type=logging::info&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message</span><span class="w">  </span><span class="c1"># call a function with one argument</span>
<span class="nt">&lt;discard&gt;&lt;type=print&gt;</span><span class="p">:</span><span class="w"> </span><span class="c1"># call a built-in function</span>
<span class="w">  </span><span class="nt">~</span><span class="p">:</span><span class="w"> </span><span class="c1"># positional arguments</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message1</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message2</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">message3</span>
<span class="w">  </span><span class="nt">sep</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="w"> </span><span class="c1"># keyword arguments</span>
</pre></div>
</div>
<p>will be parsed into</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;message1&quot;</span><span class="p">,</span> <span class="s2">&quot;message2&quot;</span><span class="p">,</span> <span class="s2">&quot;message3&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">return</span> <span class="p">{</span>
  <span class="s2">&quot;key1&quot;</span><span class="p">:</span> <span class="n">json</span><span class="p">,</span>
  <span class="s2">&quot;key2&quot;</span><span class="p">:</span> <span class="n">json</span><span class="p">,</span>
  <span class="s2">&quot;key3&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">,</span>
  <span class="s2">&quot;key4&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="o">.</span><span class="vm">__qualname__</span><span class="p">,</span>
  <span class="s2">&quot;key5&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="attr">
<span id="config-tag-attr"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;attr&gt;</span></code><a class="headerlink" href="#attr" title="Link to this heading">#</a></h3>
<p>This tag will replace the value by the its attribute. A tag like <code class="docutils literal notranslate"><span class="pre">&lt;attr=attr1.attr2&gt;</span></code> is equivalent to the pseudo code <code class="docutils literal notranslate"><span class="pre">value.attr1.attr2</span></code>.</p>
<div class="guide-config-tag admonition">
<p class="admonition-title">tag</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;attr={attribute}&gt;</span></code>: where the attribute can be a dot separated string.</p></li>
</ul>
</div>
</section>
<section id="extend">
<span id="config-tag-extend"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;extend&gt;</span></code><a class="headerlink" href="#extend" title="Link to this heading">#</a></h3>
<p>This tag will try to extend the existing value of the same key by the value, in a way given by the pseudo code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">local</span><span class="p">:</span>
  <span class="k">return</span> <span class="n">extend</span><span class="p">(</span><span class="n">local</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="k">return</span> <span class="n">value</span>
</pre></div>
</div>
<p>where the <code class="docutils literal notranslate"><span class="pre">extend</span></code> function is a binary operation specified by the tag value.</p>
<div class="guide-config-tag admonition">
<p class="admonition-title">tag</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;extend&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;extend=add&gt;</span></code>: recursively merge dictionaries or apply <code class="docutils literal notranslate"><span class="pre">+</span></code> to other types.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;extend=and&gt;</span></code>: apply <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> operation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;extend=or&gt;</span></code>: apply <code class="docutils literal notranslate"><span class="pre">|</span></code> operation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;extend={operation}&gt;</span></code>: see <a class="reference internal" href="#config-custom-extend"><span class="std std-ref">&lt;extend&gt; operation</span></a></p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The built-in extend methods will not modify the original value in-place.</p>
</div>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">parent1 &lt;var=original&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="nt">child1</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">a</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">b</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">child2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">parent1 &lt;extend&gt;</span><span class="p">:</span><span class="w"> </span><span class="c1"># recursively merge dictionaries</span>
<span class="w">  </span><span class="nt">child1</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">c</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">child2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="nt">parent2 &lt;ref&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">original</span><span class="w"> </span><span class="c1"># the original value is unmodified</span>
</pre></div>
</div>
<p>will be parsed into</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;parent1&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;child1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span>
    <span class="s2">&quot;child2&quot;</span><span class="p">:</span> <span class="mi">3</span>
  <span class="p">},</span>
  <span class="s2">&quot;parent2&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;child1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">],</span>
    <span class="s2">&quot;child2&quot;</span><span class="p">:</span> <span class="mi">1</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="var">
<span id="config-tag-var"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;var&gt;</span></code><a class="headerlink" href="#var" title="Link to this heading">#</a></h3>
<p>This tag can be used to create a variable from the value. The variable has a lifecycle spans the entire parser <a class="reference internal" href="../../api/config.html#heptools.config.ConfigParser.__call__" title="heptools.config.ConfigParser.__call__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__call__()</span></code></a> and is shared by all files within the same call. The variable can be accessed using <a class="reference internal" href="#config-tag-ref"><span class="std std-ref">&lt;ref&gt;</span></a> and is also available as <code class="docutils literal notranslate"><span class="pre">locals</span></code> in <a class="reference internal" href="#config-tag-code"><span class="std std-ref">&lt;code&gt;</span></a>.</p>
<div class="guide-config-tag admonition">
<p class="admonition-title">tag</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;var&gt;</span></code>: use the key as variable name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;var={variable}&gt;</span></code>: use the tag value as variable name.</p></li>
</ul>
</div>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span><span class="w"> </span><span class="c1"># file1.yml</span>
<span class="nt">var1 &lt;var&gt;</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">value1_1</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># use the key as variable name</span>
<span class="nt">key1 &lt;var=var2&gt;</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">value2_1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">value2_2</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># use the tag value as variable name</span>

<span class="nn">---</span><span class="w"> </span><span class="c1"># file2.yml</span>
<span class="nt">&lt;discard&gt;</span><span class="p">:</span><span class="w"> </span><span class="c1"># only make use of the variables</span>
<span class="w">  </span><span class="nt">&lt;include&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">file1.yml</span>
<span class="nt">key1 &lt;var=var3&gt;</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">value3_1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">value3_2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">value3_3</span><span class="p p-Indicator">]</span>
<span class="nt">key2 &lt;ref&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">var1</span><span class="w"> </span><span class="c1"># a reference to var1 in file1.yml, use the value as variable name</span>
<span class="nt">key3 &lt;ref=copy&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">var2</span><span class="w"> </span><span class="c1"># a copy of var2 in file1.yml, use the value as variable name</span>
<span class="nt">var3 &lt;ref=deepcopy&gt;</span><span class="p">:</span><span class="w"> </span><span class="c1"># a deepcopy of var3 in the same file, use the key as variable name</span>
<span class="nt">var3 &lt;extend&gt;</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">value3_4</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># append to the deepcopy</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&quot;file2.yml&quot;</span></code> will be parsed into:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;key1&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;value3_1&quot;</span><span class="p">,</span> <span class="s2">&quot;value3_2&quot;</span><span class="p">,</span> <span class="s2">&quot;value3_3&quot;</span><span class="p">],</span>
  <span class="s2">&quot;key2&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;value1_1&quot;</span><span class="p">],</span>
  <span class="s2">&quot;key3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;value2_1&quot;</span><span class="p">,</span> <span class="s2">&quot;value2_2&quot;</span><span class="p">],</span>
  <span class="s2">&quot;var3&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;value3_1&quot;</span><span class="p">,</span> <span class="s2">&quot;value3_2&quot;</span><span class="p">,</span> <span class="s2">&quot;value3_3&quot;</span><span class="p">,</span> <span class="s2">&quot;value3_4&quot;</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="ref">
<span id="config-tag-ref"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;ref&gt;</span></code><a class="headerlink" href="#ref" title="Link to this heading">#</a></h3>
<p>This tag can be used to access the variables defined with <a class="reference internal" href="#config-tag-var"><span class="std std-ref">&lt;var&gt;</span></a>.</p>
<div class="guide-config-tag admonition">
<p class="admonition-title">tag</p>
<ul class="simple">
<li><p>If the value is a string, it will be used as the variable name. Otherwise, the key will be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;ref&gt;</span></code>: replace the value by a reference to the variable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;ref=copy&gt;</span></code>: replace the value by a <a class="reference external" href="https://docs.python.org/3/library/copy.html#copy.copy" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy()</span></code></a> of the variable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;ref=deepcopy&gt;</span></code>: replace the value by a <a class="reference external" href="https://docs.python.org/3/library/copy.html#copy.deepcopy" title="(in Python v3.13)"><code class="xref py py-func docutils literal notranslate"><span class="pre">deepcopy()</span></code></a> of the variable.</p></li>
</ul>
</div>
</section>
<section id="map">
<span id="config-tag-map"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;map&gt;</span></code><a class="headerlink" href="#map" title="Link to this heading">#</a></h3>
<p>This tag converts a list of key-value pairs into a dictionary, which makes it possible to apply the tags that only work with values to the keys.</p>
<div class="guide-config-value admonition">
<p class="admonition-title">value</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code>: a list of dictionaries with keys <code class="docutils literal notranslate"><span class="pre">key</span></code> and <code class="docutils literal notranslate"><span class="pre">val</span></code>.</p></li>
</ul>
</div>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">parent &lt;map&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key &lt;type=tuple&gt;</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="s">&quot;child&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">]]</span>
<span class="w">    </span><span class="nt">val</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key &lt;type=tuple&gt;</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[[</span><span class="s">&quot;child&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">]]</span>
<span class="w">    </span><span class="nt">val</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value2</span>
</pre></div>
</div>
<p>will be parsed into</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;parent&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">(</span><span class="s2">&quot;child&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="s2">&quot;value1&quot;</span><span class="p">,</span>
    <span class="p">(</span><span class="s2">&quot;child&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="s2">&quot;value2&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="select">
<span id="config-tag-select"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;select&gt;</span></code><a class="headerlink" href="#select" title="Link to this heading">#</a></h3>
<p>This tag implements a conditional statement to evaluate each case and insert the selected ones into the current position. Each case is a dictionary where the keys with <a class="reference internal" href="#config-tag-case"><span class="std std-ref">&lt;case&gt;</span></a> (case-keys) will be interpreted as booleans and contribute to the decision, while others (non-case-keys) will be used to construct the parent dictionary if the final decision is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">&lt;select=all&gt;</span></code>, all case-keys and the selected non-case-keys will be parsed. When <code class="docutils literal notranslate"><span class="pre">&lt;select=first&gt;</span></code>, everything after the first selected case will not be parsed. The selected non-case-keys are parsed under the same context as <code class="docutils literal notranslate"><span class="pre">&lt;select&gt;</span></code>.</p>
<div class="guide-config-tag admonition">
<p class="admonition-title">tag</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;select&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;select=first&gt;</span></code>: insert the first selected case only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;select=all&gt;</span></code>: insert all selected cases.</p></li>
</ul>
</div>
<div class="guide-config-value admonition">
<p class="admonition-title">value</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code>: a list of dictionaries with <a class="reference internal" href="#config-tag-case"><span class="std std-ref">&lt;case&gt;</span></a> keys.</p></li>
</ul>
</div>
<div class="guide-config-example dropdown admonition">
<p class="admonition-title">example</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">count &lt;var&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="nt">selected</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">before</span><span class="p p-Indicator">]</span>
<span class="nt">&lt;select=all&gt;</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">&lt;case&gt; &lt;code&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">count % 2 == 0</span>
<span class="w">    </span><span class="nt">selected &lt;extend&gt;</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">A</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">&lt;discard&gt; &lt;type=print&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">count is even</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">&lt;case&gt; &lt;code&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">count % 2 == 1</span>
<span class="w">    </span><span class="nt">selected &lt;extend&gt;</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">B</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">&lt;discard&gt; &lt;type=print&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">count is odd</span><span class="w"> </span><span class="c1"># will not print</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">&lt;case&gt; &lt;code&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">count &gt; 5</span>
<span class="w">    </span><span class="nt">selected &lt;extend&gt;</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">C</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">&lt;case&gt; &lt;code&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">count &gt; 5</span>
<span class="w">    </span><span class="nt">&lt;case=xor&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"> </span><span class="c1"># count &lt;= 5</span>
<span class="w">    </span><span class="nt">selected &lt;extend&gt;</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">D</span><span class="p p-Indicator">]</span>
<span class="nt">selected &lt;extend&gt;</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">after</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>will be parsed into</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;count is even&quot;</span><span class="p">)</span>

<span class="k">return</span> <span class="p">{</span>
  <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
  <span class="s2">&quot;selected&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;before&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;after&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
<section id="case">
<span id="config-tag-case"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;case&gt;</span></code><a class="headerlink" href="#case" title="Link to this heading">#</a></h3>
<p>This tag will only be parsed when used inside <a class="reference internal" href="#config-tag-select"><span class="std std-ref">&lt;select&gt;</span></a> to modify the decision. Each case will start with the decision set to <code class="docutils literal notranslate"><span class="pre">False</span></code> and the keys with <code class="docutils literal notranslate"><span class="pre">&lt;case&gt;</span></code> will update the decision based on the value using the operation specified by the tag value.</p>
<div class="guide-config-tag admonition">
<p class="admonition-title">tag</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;case&gt;</span></code>: set the decision to the value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;case=or&gt;</span></code>: update the decision by <code class="docutils literal notranslate"><span class="pre">|</span></code> with the value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;case=and&gt;</span></code>: update the decision by <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> the value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;case=xor&gt;</span></code>: update the decision by <code class="docutils literal notranslate"><span class="pre">^</span></code> the value.</p></li>
</ul>
</div>
</section>
</section>
<section id="support">
<h2>Support<a class="headerlink" href="#support" title="Link to this heading">#</a></h2>
<p>An <a class="reference external" href="https://code.visualstudio.com/">VS Code</a> extension is provided for syntax highlight. The extension is enabled for the following files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">YAML</span></code>: <code class="docutils literal notranslate"><span class="pre">*.cfg.yaml</span></code>, <code class="docutils literal notranslate"><span class="pre">*.cfg.yml</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">JSON</span></code>: <code class="docutils literal notranslate"><span class="pre">*.cfg.json</span></code></p></li>
</ul>
<p>To install the extension, download the <code class="docutils literal notranslate"><span class="pre">heptools-config-support-X.X.X.vsix</span></code> from one of the <a class="reference external" href="https://github.com/chuyuanliu/heptools/releases">releases</a>.</p>
<section id="syntax-highlight">
<h3>Syntax Highlight<a class="headerlink" href="#syntax-highlight" title="Link to this heading">#</a></h3>
<p>The tokenization is implemented using <a class="reference external" href="https://macromates.com/manual/en/language_grammars">TextMate grammars</a>, which covers most of the tag rules with the following exceptions:</p>
<ul class="simple">
<li><p>no flag conflicts check</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;file=absolute|relative&gt;</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span><span class="w"> </span><span class="c1"># this will be highlighted but fail the parsing</span>
</pre></div>
</div>
<ul class="simple">
<li><p>no multiline key validation</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">?</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">key</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">&lt;tag&gt;</span><span class="w"> </span><span class="c1"># this will be highlighted but not parsed</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">key</span>
<span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
</pre></div>
</div>
</section>
</section>
<section id="customization">
<span id="config-customization"></span><h2>Customization<a class="headerlink" href="#customization" title="Link to this heading">#</a></h2>
<section id="tag-parser">
<span id="config-custom-tag"></span><h3>Tag parser<a class="headerlink" href="#tag-parser" title="Link to this heading">#</a></h3>
</section>
<section id="extend-operation">
<span id="config-custom-extend"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;extend&gt;</span></code> operation<a class="headerlink" href="#extend-operation" title="Link to this heading">#</a></h3>
</section>
<section id="file-deserializer">
<span id="config-custom-deserializer"></span><h3>File deserializer<a class="headerlink" href="#file-deserializer" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="tips-tricks">
<h2>Tips &amp; Tricks<a class="headerlink" href="#tips-tricks" title="Link to this heading">#</a></h2>
<section id="dynamic-include">
<span id="config-tips-include"></span><h3>Dynamic <code class="docutils literal notranslate"><span class="pre">&lt;include&gt;</span></code><a class="headerlink" href="#dynamic-include" title="Link to this heading">#</a></h3>
</section>
<section id="keyword-tag-values">
<h3>Keyword tag values<a class="headerlink" href="#keyword-tag-values" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="advanced">
<h2>Advanced<a class="headerlink" href="#advanced" title="Link to this heading">#</a></h2>
<p>The following tags are not recommended for general usage and may lead to unexpected results or significantly increase the maintenance complexity.</p>
<section id="patch">
<span id="config-tag-patch"></span><h3><code class="docutils literal notranslate"><span class="pre">&lt;patch&gt;</span></code><a class="headerlink" href="#patch" title="Link to this heading">#</a></h3>
<p># TODO patch</p>
</section>
<section id="customized-patch-action">
<span id="config-custom-patch"></span><h3>Customized <code class="docutils literal notranslate"><span class="pre">&lt;patch&gt;</span></code> action<a class="headerlink" href="#customized-patch-action" title="Link to this heading">#</a></h3>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../optional.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Optional Components</p>
      </div>
    </a>
    <a class="right-next"
       href="../../api.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">API reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-start">Quick Start</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#write-configs">Write configs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-configs">Load configs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tag">Tag</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#syntax">Syntax</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#precedence">Precedence</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#url-and-io">URL and IO</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#special">Special</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nested-true-in-configparser"><code class="docutils literal notranslate"><span class="pre">nested=True</span></code> in <code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigParser</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#none-key"><code class="docutils literal notranslate"><span class="pre">None</span></code> key</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#apply-to-list-elements">Apply to <code class="docutils literal notranslate"><span class="pre">list</span></code> elements</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#built-in-tags">Built-in tags</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code"><code class="docutils literal notranslate"><span class="pre">&lt;code&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#include"><code class="docutils literal notranslate"><span class="pre">&lt;include&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#literal"><code class="docutils literal notranslate"><span class="pre">&lt;literal&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discard"><code class="docutils literal notranslate"><span class="pre">&lt;discard&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comment"><code class="docutils literal notranslate"><span class="pre">&lt;comment&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#file"><code class="docutils literal notranslate"><span class="pre">&lt;file&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type"><code class="docutils literal notranslate"><span class="pre">&lt;type&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#attr"><code class="docutils literal notranslate"><span class="pre">&lt;attr&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extend"><code class="docutils literal notranslate"><span class="pre">&lt;extend&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#var"><code class="docutils literal notranslate"><span class="pre">&lt;var&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ref"><code class="docutils literal notranslate"><span class="pre">&lt;ref&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#map"><code class="docutils literal notranslate"><span class="pre">&lt;map&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#select"><code class="docutils literal notranslate"><span class="pre">&lt;select&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#case"><code class="docutils literal notranslate"><span class="pre">&lt;case&gt;</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#support">Support</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#syntax-highlight">Syntax Highlight</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#customization">Customization</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tag-parser">Tag parser</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extend-operation"><code class="docutils literal notranslate"><span class="pre">&lt;extend&gt;</span></code> operation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#file-deserializer">File deserializer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tips-tricks">Tips &amp; Tricks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamic-include">Dynamic <code class="docutils literal notranslate"><span class="pre">&lt;include&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#keyword-tag-values">Keyword tag values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced">Advanced</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#patch"><code class="docutils literal notranslate"><span class="pre">&lt;patch&gt;</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customized-patch-action">Customized <code class="docutils literal notranslate"><span class="pre">&lt;patch&gt;</span></code> action</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/chuyuanliu/heptools/edit/master/docs/guide/optional/config_parser.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/guide/optional/config_parser.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023-2025, Chuyuan Liu.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>